## попробуйте из под user3 выполнить sudo ls -l /root
user3 is not in the sudoers file.  This incident will be reported.

## почему у вас не получилось?
Команда sudo позволяет обычным пользователям выполнять программы от имени суперпользователя со всеми его правами. Использовать команду sudo могут далеко не все пользователи, а только те, которые указаны в файле /etc/sudoers. Это сообщение об ошибке говорит буквально следующее - вашего пользователя нет в файле sudoers, а значит доступ ему к утилите будет запрещен, а об этом инциденте будет сообщено администратору.

sudo nano /etc/sudoers 
![sq1](https://github.com/sashaukl/linux_labs/blob/master/Screenshot%20from%202019-11-20%2019-00-24.png)



![sq2](https://github.com/sashaukl/linux_labs/blob/master/cq2.png)
![sq3](https://github.com/sashaukl/linux_labs/blob/master/sq3.png)

_______________________________________________________________________________________________________
# Lab-processes.md
### Какой размер дисков?
один диск 931,5гб

### Есть ли неразмеченное место на дисках?
нет

### Какой размер партиций?
![sq3](https://github.com/sashaukl/linux_labs/blob/master/sq4.png)

### Какая таблица партционирования используется?
gpt

### Какой диск, партция или лвм том смонтированы в /
sda4 
![](https://github.com/sashaukl/linux_labs/blob/master/sq5.png)

### Создадим сжатую файловую систему для чтения squashfs
git clone https://gitlab.com/erlong15/mai.git
mksquashfs mai/* mai.sqsh
![](https://github.com/sashaukl/linux_labs/blob/master/sq6.png)


## Посмотрим информацию по файловым системам смонтированным в системе
### Какая файловая система примонтирована в /
![](https://github.com/sashaukl/linux_labs/blob/master/sq7.png)

### С какими опциями примонтирована файловая система в /
mount | grep sda4
/dev/sda4 on / type ext4 (rw,relatime,errors=remount-ro)

### Какой размер файловой системы приментированной в /mnt/mai
/dev/loop8      128K  128K     0 100% /mnt/mai
128K

### Что такое tmpfs?
Tmpfs — временное файловое хранилище

### Какая часть памяти изменялась?
100M
![](https://github.com/sashaukl/linux_labs/blob/master/sq8.png)

### Какие процессы в системе порождают дочерние процессы через fork
systemd, gdm3, kthreadd

### Какие процессы в системе являются мультитредовыми
firefox, kthreadd

### Разберитесь что делает команда (ps axo rss | tail -n +2|paste -sd+ | bc)
Cчитыватеn кол-во занятой оперативной пямяти не в swap использованной в процессах всех пользователей странная потому что она в кб

## Уставновим утилиту smem и проанализируем параметр PSS в ней
![](https://github.com/sashaukl/linux_labs/blob/master/sq9.png)

## Запустим приложеннный скрипт и понаблюдаем за процессами
### в другом терминале  отследите порождение процессов
![](https://github.com/sashaukl/linux_labs/blob/master/sq10.png)
### отследите какие состояния вы видите у процессов
T и Z
### почему появляются процессы со статусам Z
зомби процессы
### какой PID у основного процесса
23009
### убейте основной процесс kill -9 <pid> какой PPID стал у первого чайлда
23009
### насколько вы разобрались в скрипте и втом что он делает?
В ограниченном цикле с делаем штампует новые форки

## Научимся корректно завершать зомби процессы
запустим еще раз наш процесс
убьем процесс первого чайлда
проверим его состояние  и убедимся что он зомби
остановим основной процесс
расскоментируем строки в скрипте
поторим все еще раз
отследим корректное завершение чайлда
![](https://github.com/sashaukl/linux_labs/blob/master/sq11.png)

## Научимся убивать зомби процессы
Bye
![](https://github.com/sashaukl/linux_labs/blob/master/sq12.png)

##Проблемы при отмонтировании директории
- target is busy
user 18558 ..c.. bash
мешает баш, убиваем по пиду и закрыватся терминал)
команда срабатывает при выходе из папки
device is busy

## Решаем загадку исчезновения места на диске
После удаления файла usage увеличился на 4% мы удалили файл, но процесс который щаписывает в память все еще жив, он и есть память. 

## Утилиты наблюдения
- проверьте текущий LA  load average: 3,37, 2,80, 2,2
cat /proc/loadavg
- запишите top 3 процессов загружающих CPU
 top -b -o +%CPU | head -n 10
- запишите top 3 процессов загружающих память
top -b -o +%MEM | head -n 10
